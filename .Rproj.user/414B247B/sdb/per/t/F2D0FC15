{
    "contents" : "# Clear Memory, loading package\nrm(list=ls())\nlibrary(glmnet)\n\n# Read data\ndata.diff <- dget(\"arranged-data/data-diff-2013.R\")\ndata.diff <- data.diff[,-c(1,2)]\ndata.tourney <- dget(\"arranged-data/data-tourney-diff-2013.R\")\ndata.tourney <- data.tourney[,-c(1,2)]\n\n# Process data\ndata.diff[,2] <- as.factor(data.diff[,2])\ndata.diff[,4] <- as.factor(data.diff[,4])\ndata.diff[,6] <- as.factor(data.diff[,6])\ndata.tourney[,2] <- as.factor(data.tourney[,2])\ndata.tourney[,4] <- as.factor(data.tourney[,4])\ndata.tourney[,6] <- as.factor(data.tourney[,6])\nmyY <- data.diff[,1]\nmyX <- data.matrix(data.diff[,-1])\nnewY <- data.tourney[,1]\nnewX <- data.matrix(data.tourney[,-1])\n\n# -------------------- Fitting Linear Model -------------------- #\n\nfit = glmnet(x=myX, y=myY, alpha = 1)\npar(mfrow=c(1,1))\nplot(fit, xvar = \"lambda\", label = TRUE)\nplot(fit, xvar = \"dev\", label = TRUE)\n\ncvfit = cv.glmnet(x=myX, y=myY, type.measure = \"mse\", nfolds = 20)\nplot(cvfit, xvar = \"lambda\", label = TRUE)\n\nnewPred <- predict(cvfit, newx = newX, s = \"lambda.min\")\nplot(newY, newPred)\naccuracy <- newY * newPred > 0\nsum(accuracy) / length(accuracy)\n\n# -------------------- Fitting Logistic Model -------------------- #\n\nmyY <- sapply(myY, function(y){return(y>0)})\nmyY <- as.factor(myY)\nnewY <- sapply(newY, function(y){return(y>0)})\nnewY <- as.factor(newY)\n\nfit = glmnet(x=myX, y=myY, family = \"binomial\")\nplot(fit, xvar = \"dev\", label = TRUE)\n\ncvfit = cv.glmnet(x=myX, y=myY, type.measure = \"class\", nfolds = 20ï¼Œ family = \"binomial\")\nplot(cvfit, xvar = \"lambda\", label = TRUE)\ncvfit$lambda.min\n\nnewPred <- predict(cvfit, newx = newX, type = \"class\", s = \"lambda.min\")\nsum(newY == newPred) / length(newY)\n\n\nnewPred <- predict(cvfit, newx = newX, s = \"lambda.min\", type=\"response\")\nlogloss <- 0\nfor(i in 1:length(newY)) {\n  if(newY[i]==\"TRUE\") logloss <- logloss + log(newPred[i])\n  else logloss <- logloss + log(1-newPred[i])\n}\n\nlogloss <- -logloss/length(newY)",
    "created" : 1428535390686.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3244570140",
    "id" : "F2D0FC15",
    "lastKnownWriteTime" : 1428542080,
    "path" : "D:/Github/2015-NCAA-Basketball-Tournament-Predicting/3-lasso.R",
    "project_path" : "3-lasso.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}