rm(list=ls())
teams <- read.csv("teams.csv")
teamAverage <- read.csv("team_average.csv")
tDetailed <- read.csv("tourney_detailed_results.csv")
TEAM <- teams$team_id
YEAR <- sort(unique(tDetailed$season), decreasing=T)
logic.win <- sapply(names(tDetailed),function(varname){
if(substring(varname, 1, 1) == "w"){
return(T)
} else {
return(F)
}
})
logic.win[3] <- F
logic.win[7] <- F
NAME <- sapply(names(tDetailed[logic.win]), function(varname) {
return(paste("dif.", substring(varname, 2), sep=""))
})
names(NAME) <- NULL
NAME
NAME <- NAME[-1]
NAME
tempData <- list()
for(i in 1:nrow(tDetailed)) {
if(tDetailed[i,3] < tDetailed[i,5]) {
sea <- tDetailed[i,1]
t1 <- tDetailed[i,3]
t2 <- tDetailed[i,5]
ds <- tDetailed[i,4] - tDetailed[i,6]
} else {
sea <- tDetailed[i,1]
t1 <- tDetailed[i,5]
t2 <- tDetailed[i,3]
ds <- tDetailed[i,6] - tDetailed[i,4]
}
tempData[[i]] <- c(sea,t1,t2,ds)
}
tempData <- sapply(tempData, function(t) {return(t)})
tempData <- as.data.frame(t(tempData))
length(NAME)
tourData <- matrix(0, nrow(tempData), ncol(tempData)+length(NAME))
tourData <- as.data.frame(tourData)
names(tourData) <- c("season", "team1", "team2", "dif.score", NAME)
View(tourData)
for(i in 1:nrow(tourData)) {
y <- tourData[i,1]
t1 <- tourData[i,2]
t2 <- tourData[i,3]
y <- ((2014-y)*14+3) : ((2015-y)*14+1)
t1 <- which(teamAverage[,1]==t1)
t2 <- which(teamAverage[,1]==t2)
tourData[i,5:18] <- teamAverage[t1,y] - teamAverage[t2,y]
}
tourData <- matrix(0, nrow(tempData), ncol(tempData)+length(NAME))
tourData <- as.data.frame(tourData)
names(tourData) <- c("season", "team1", "team2", "dif.score", NAME)
tourData[,1:4] <- tempData
for(i in 1:nrow(tourData)) {
y <- tourData[i,1]
t1 <- tourData[i,2]
t2 <- tourData[i,3]
y <- ((2014-y)*14+3) : ((2015-y)*14+1)
t1 <- which(teamAverage[,1]==t1)
t2 <- which(teamAverage[,1]==t2)
tourData[i,5:18] <- teamAverage[t1,y] - teamAverage[t2,y]
}
y <- tourData[i,1]
t1 <- tourData[i,2]
t2 <- tourData[i,3]
y <- ((2014-y)*14+3) : ((2015-y)*14+1)
t1 <- which(teamAverage[,1]==t1)
t2 <- which(teamAverage[,1]==t2)
tourData[i,5:17] <- teamAverage[t1,y] - teamAverage[t2,y]
for(i in 1:nrow(tourData)) {
y <- tourData[i,1]
t1 <- tourData[i,2]
t2 <- tourData[i,3]
y <- ((2014-y)*14+3) : ((2015-y)*14+1)
t1 <- which(teamAverage[,1]==t1)
t2 <- which(teamAverage[,1]==t2)
tourData[i,5:17] <- teamAverage[t1,y] - teamAverage[t2,y]
}
View(teamAverage)
View(tourData)
rm(list=ls())
teams <- read.csv("teams.csv")
teamAverage <- read.csv("team_average.csv")
tDetailed <- read.csv("tourney_detailed_results.csv")
TEAM <- teams$team_id
YEAR <- sort(unique(tDetailed$season), decreasing=T)
logic.win <- sapply(names(tDetailed),function(varname){
if(substring(varname, 1, 1) == "w"){
return(T)
} else {
return(F)
}
})
logic.win[3] <- F
logic.win[7] <- F
NAME <- sapply(names(tDetailed[logic.win]), function(varname) {
return(paste("dif.", substring(varname, 2), sep=""))
})
names(NAME) <- NULL
NAME <- NAME[-1]
# -------------------- 1 -------------------- #
tempData <- list()
for(i in 1:nrow(tDetailed)) {
if(tDetailed[i,3] < tDetailed[i,5]) {
sea <- tDetailed[i,1]
t1 <- tDetailed[i,3]
t2 <- tDetailed[i,5]
ds <- tDetailed[i,4] - tDetailed[i,6]
} else {
sea <- tDetailed[i,1]
t1 <- tDetailed[i,5]
t2 <- tDetailed[i,3]
ds <- tDetailed[i,6] - tDetailed[i,4]
}
tempData[[i]] <- c(sea,t1,t2,ds)
}
tempData <- sapply(tempData, function(t) {return(t)})
tempData <- as.data.frame(t(tempData))
# -------------------- 2 -------------------- #
tourData <- matrix(0, nrow(tempData), ncol(tempData)+length(NAME))
tourData <- as.data.frame(tourData)
names(tourData) <- c("season", "team1", "team2", "dif.score", NAME)
tourData[,1:4] <- tempData
for(i in 1:nrow(tourData)) {
y <- tourData[i,1]
t1 <- tourData[i,2]
t2 <- tourData[i,3]
y <- ((2014-y)*14+3) : ((2015-y)*14+1)
t1 <- which(teamAverage[,1]==t1)
t2 <- which(teamAverage[,1]==t2)
tourData[i,5:17] <- teamAverage[t1,y] - teamAverage[t2,y]
}
write.csv(tourData,"tourData.csv")
rm(list=ls())
tour <- read.csv("tourData.csv")
View(tour)
tour <- tour[,-1]
tour[1] == 213
myData <- tour[tour[1]==2013,]
View(myData)
row.names(myData) <- NULL
View(myData)
rm(list=ls())
tour <- read.csv("tourData.csv")
tour <- tour[,-1]
myData <- tour[tour[1]==2013,]
myData[,3:17]
rm(list=ls())
tour <- read.csv("tourData.csv")
tour <- tour[,-1]
myData <- tour[tour[1]==2013,]
myData <- myData[,3:17]
View(myData)
rm(list=ls())
tour <- read.csv("tourData.csv")
tour <- tour[,-1]
myData <- tour[tour[1]==2013,]
View(myData)
row.names(myData) <- NULL
myData <- myData[,4:17]
row.names(myData) <- NULL
View(myData)
myModel <- lm(dif.score~. , data=myData)
plot(myData[,1],predict(myModel))
summary(myModel)
plot(myData[,1],predict(myModel))
plot(myData[,1],myData[,1])
predict(myModel)
plot(myData[,1],predict(myModel))
rm(list=ls())
tour <- read.csv("tourData.csv")
tour <- tour[,-1]
myData <- tour[tour[1]==2013,]
myData <- myData[,4:17]
row.names(myData) <- NULL
myModel <- lm(dif.score~. , data=myData)
plot(myData[,1],predict(myModel))
summary(myModel)
myY <- sapply(myData[,1], function(d) {
if(d>0) {return(1)}
else {return(0)}
})
myYpred <- sapply(predict(myModel), function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
myData[,1] <- myY
myModel <- glm(dif.score~. , data=myData, family = "binomial")
summary(myModel)
myYpred <- sapply(predict(myModel), function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
newData <- tour[tour[1]==2014,]
newData <- newData[,4:17]
row.names(newData) <- NULL
View(newData)
myPred <- predict(myModel,newData)
myPred
myPred <- predict(myModel,newData[,-1])
myPred
myPred <- predict(myModel,newData[,5:14])
myPred <- predict(myModel,newData[,5:16])
myPred <- predict(myModel,newData[,5:13])
myPred <- predict(myModel,newData[,6:14])
myPred <- predict(myModel,newData[,6:14])
View(newData)
myPred <- predict(myModel,newData[,2:13])
myPred <- predict(myModel,newData[,2:14])
myPred
myY <- sapply(myData[,2], function(d) {
if(d>0) {return(1)}
else {return(0)}
})
myYpred <- sapply(myPred, function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
rm(list=ls())
tour <- read.csv("tourData.csv")
tour <- tour[,-1]
myData <- tour[tour[1]==2003,]
myData <- myData[,4:17]
row.names(myData) <- NULL
myModel <- lm(dif.score~. , data=myData)
plot(myData[,1],predict(myModel))
summary(myModel)
myY <- sapply(myData[,1], function(d) {
if(d>0) {return(1)}
else {return(0)}
})
myYpred <- sapply(predict(myModel), function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
# -------------------- 1 -------------------- #
myData[,1] <- myY
myModel <- glm(dif.score~. , data=myData, family = "binomial")
summary(myModel)
myYpred <- sapply(predict(myModel), function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
# -------------------- 2 -------------------- #
newData <- tour[tour[1]==2004,]
newData <- newData[,4:17]
row.names(newData) <- NULL
myPred <- predict(myModel,newData[,2:14])
myY <- sapply(myData[,2], function(d) {
if(d>0) {return(1)}
else {return(0)}
})
myYpred <- sapply(myPred, function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
rm(list=ls())
tour <- read.csv("tourData.csv")
tour <- tour[,-1]
myData <- tour[tour[1]==2004,]
myData <- myData[,4:17]
row.names(myData) <- NULL
myModel <- lm(dif.score~. , data=myData)
plot(myData[,1],predict(myModel))
summary(myModel)
myY <- sapply(myData[,1], function(d) {
if(d>0) {return(1)}
else {return(0)}
})
myYpred <- sapply(predict(myModel), function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
# -------------------- 1 -------------------- #
myData[,1] <- myY
myModel <- glm(dif.score~. , data=myData, family = "binomial")
summary(myModel)
myYpred <- sapply(predict(myModel), function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
# -------------------- 2 -------------------- #
newData <- tour[tour[1]==2005,]
newData <- newData[,4:17]
row.names(newData) <- NULL
myPred <- predict(myModel,newData[,2:14])
myY <- sapply(myData[,2], function(d) {
if(d>0) {return(1)}
else {return(0)}
})
myYpred <- sapply(myPred, function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
rm(list=ls())
tour <- read.csv("tourData.csv")
tour <- tour[,-1]
myData <- tour[tour[1]==2005,]
myData <- myData[,4:17]
row.names(myData) <- NULL
myModel <- lm(dif.score~. , data=myData)
plot(myData[,1],predict(myModel))
summary(myModel)
myY <- sapply(myData[,1], function(d) {
if(d>0) {return(1)}
else {return(0)}
})
myYpred <- sapply(predict(myModel), function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
# -------------------- 1 -------------------- #
myData[,1] <- myY
myModel <- glm(dif.score~. , data=myData, family = "binomial")
summary(myModel)
myYpred <- sapply(predict(myModel), function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
# -------------------- 2 -------------------- #
newData <- tour[tour[1]==2006,]
newData <- newData[,4:17]
row.names(newData) <- NULL
myPred <- predict(myModel,newData[,2:14])
myY <- sapply(myData[,2], function(d) {
if(d>0) {return(1)}
else {return(0)}
})
myYpred <- sapply(myPred, function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
rm(list=ls())
tour <- read.csv("tourData.csv")
tour <- tour[,-1]
myData <- tour[tour[1]==2006,]
myData <- myData[,4:17]
row.names(myData) <- NULL
myModel <- lm(dif.score~. , data=myData)
plot(myData[,1],predict(myModel))
summary(myModel)
myY <- sapply(myData[,1], function(d) {
if(d>0) {return(1)}
else {return(0)}
})
myYpred <- sapply(predict(myModel), function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
# -------------------- 1 -------------------- #
myData[,1] <- myY
myModel <- glm(dif.score~. , data=myData, family = "binomial")
summary(myModel)
myYpred <- sapply(predict(myModel), function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
# -------------------- 2 -------------------- #
newData <- tour[tour[1]==2007,]
newData <- newData[,4:17]
row.names(newData) <- NULL
myPred <- predict(myModel,newData[,2:14])
myY <- sapply(myData[,2], function(d) {
if(d>0) {return(1)}
else {return(0)}
})
myYpred <- sapply(myPred, function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
rm(list=ls())
tour <- read.csv("tourData.csv")
tour <- tour[,-1]
myData <- tour[tour[1]==2006,]
myData <- myData[,4:17]
row.names(myData) <- NULL
myModel <- lm(dif.score~. , data=myData)
plot(myData[,1],predict(myModel))
summary(myModel)
myY <- sapply(myData[,1], function(d) {
if(d>0) {return(1)}
else {return(0)}
})
myYpred <- sapply(predict(myModel), function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
# -------------------- 1 -------------------- #
myData[,1] <- myY
myModel <- glm(dif.score~. , data=myData, family = "binomial")
summary(myModel)
myYpred <- sapply(predict(myModel), function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
# -------------------- 2 -------------------- #
newData <- tour[tour[1]==2008,]
newData <- newData[,4:17]
row.names(newData) <- NULL
myPred <- predict(myModel,newData[,2:14])
myY <- sapply(myData[,2], function(d) {
if(d>0) {return(1)}
else {return(0)}
})
myYpred <- sapply(myPred, function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
rm(list=ls())
tour <- read.csv("tourData.csv")
tour <- tour[,-1]
myData <- tour[tour[1]==2006,]
myData <- myData[,4:17]
row.names(myData) <- NULL
myModel <- lm(dif.score~. , data=myData)
plot(myData[,1],predict(myModel))
summary(myModel)
myY <- sapply(myData[,1], function(d) {
if(d>0) {return(1)}
else {return(0)}
})
myYpred <- sapply(predict(myModel), function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
# -------------------- 1 -------------------- #
myData[,1] <- myY
myModel <- glm(dif.score~. , data=myData, family = "binomial")
summary(myModel)
myYpred <- sapply(predict(myModel), function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
# -------------------- 2 -------------------- #
newData <- tour[tour[1]==2009,]
newData <- newData[,4:17]
row.names(newData) <- NULL
myPred <- predict(myModel,newData[,2:14])
myY <- sapply(myData[,2], function(d) {
if(d>0) {return(1)}
else {return(0)}
})
myYpred <- sapply(myPred, function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
rm(list=ls())
tour <- read.csv("tourData.csv")
tour <- tour[,-1]
myData <- tour[tour[1]==2006,]
myData <- myData[,4:17]
row.names(myData) <- NULL
myModel <- lm(dif.score~. , data=myData)
plot(myData[,1],predict(myModel))
summary(myModel)
myY <- sapply(myData[,1], function(d) {
if(d>0) {return(1)}
else {return(0)}
})
myYpred <- sapply(predict(myModel), function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
# -------------------- 1 -------------------- #
myData[,1] <- myY
myModel <- glm(dif.score~. , data=myData, family = "binomial")
summary(myModel)
myYpred <- sapply(predict(myModel), function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
# -------------------- 2 -------------------- #
newData <- tour[tour[1]==2010,]
newData <- newData[,4:17]
row.names(newData) <- NULL
myPred <- predict(myModel,newData[,2:14])
myY <- sapply(myData[,2], function(d) {
if(d>0) {return(1)}
else {return(0)}
})
myYpred <- sapply(myPred, function(d) {
if(d>0) {return(1)}
else {return(0)}
})
sum(myY == myYpred) / length(myY)
